# Client for GoCardless Enterprise API

**WARNING: This Client is Auto-Generated by [Crank](https://github.com/gocardless/crank).
Do NOT create changes or pull requests for individual changes to the client code. See
[Contributing](#contributing)**
## Installation

Add this line to your application's Gemfile:

```ruby
gem '<no value>'
```

## Usage Examples

- In the case of singular responses, Crank will return you an unenveloped hash.
- In the case of list responses, Crank returns an unenveloped Array of hashes.
- In the case of non JSON responses, Crank will return the raw response (PDFs etc)

### GET requests

Simple requests can be made like this:

```
GoCardless.resource.list
```

If you need to pass any options, the last (or in the absence of URL params, the only) argument is an options hash. You can use this to pass query params and headers like this:

```
GoCardless.resource.list(headers: { 'Foo' => 'Baz' }, query: { limit: 400 })
```

In the case where url parameters are needed, the method signature will contain required arguments:

```
GoCardless.resource.show(resource_id)
```

As with list, the last argument can be an options hash:

```
GoCardless.resource.show(resource_id, query: { limit: 200 }, headers: { 'Foo' => 'Bar' })
```

### POST/PUT Requests
If your request needs a body, you can add this in the same way you would add query params or headers.
**However**, you need to add the enveloping key!

```
GoCardless.resource.create(body: {
    resources: {
        first_name: "Pete",
        last_name: "Hamilton",
        ...
    }
})
```

As with GET requests, if href params are required they come first

```
GoCardless.resource.update(resource_id, body: { ... })
```

### Handling failures

When an API returns an error, Crank will return an `ApiError`.

Assuming the error response form the server is in JSON format, like:

```
{
  "error": {
    "documentation_url": "https://developer.gocardless.com/enterprise#validation_failed",
    "message": "Validation failed",
    "type": "validation_failed",
    "code": 422,
    "request_id": "dd50eaaf-8213-48fe-90d6-5466872efbc4",
    "errors": [
      {
        "message": "must be a number",
        "field": "sort_code"
      }, {
        "message": "is the wrong length (should be 8 characters)",
        "field": "sort_code"
      }
    ]
  }
}
```

Crank will return an GoCardless::Core::ApiError error. You can access the raw hash (unenveloped) via a `.errors` method, by default the error message will contain the error's message and a link to the documentation if it exists.



## Re-Generating the Client

The client has an `.atum.yml` file which defines some defaults, meaning you can re-generate the client really easily by navigating to the client's root and running:

```
$ atum generate --file PATH_TO_SCHEMA
```

If for any reason, you need to override the URL or headers, you can do so using cli options. To see the full range of available options, use:

```
$ atum help
```

As always, make your changes in a branch and then when satisfied, merge into master and bump the version (don't forget to add tags!

You can do this via:

```
$ gem bump --version (patch|minor|major) --tag
```

## Supporting Ruby < 2.0.0
Crank only supports Ruby >= 2.0.0 out of the box due to our use of
Enumerable::Lazy for lazy loading of paginated API resources.

However, support for previous ruby versions can be added using a gem such as
[backports](https://github.com/marcandre/backports).

1. Add backports to your Gemfile
   ```gem 'backports'```
2. Require lazy enumerables
   ```require 'backports/2.0.0/enumerable/lazy.rb'```



## Contributing

This client is auto-generated. If there's a bug it's likely with the
[Crank](https://github.com/gocardless/crank) template or Crank itself.

Bugs should be reports on those respective repositories.
